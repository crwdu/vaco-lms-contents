# 6. Optimization

# useMemo Hook

[_useMemo_](https://reactjs.org/docs/hooks-reference.html#usememo) Hookì€ ì—¬ëŸ¬ë¶„ì´ ì´ë¯¸ ì•Œê³  ìˆëŠ” lodashì˜ memoizeì™€ ìœ ì‚¬í•œ ê¸°ëŠ¥ì„ í•˜ëŠ” React API ì…ë‹ˆë‹¤. ì–´ë–¤ í•¨ìˆ˜ì˜ ì—°ì‚°ê°’ì„ memoize í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
const result = useMemo(() => computeExpensiveValue(a, b), [a, b]);
```

**ğŸ“– _useMemo_**

[Hooks API Reference - React](https://reactjs.org/docs/hooks-reference.html#usememo)

## ì£¼ìš”ê¸°ëŠ¥

ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ëŠ” ìƒëª…ì£¼ê¸°ì— ë”°ë¼, ì—…ë°ì´íŠ¸ ëœ ì •ë³´ê°€ ì¡´ì¬í• ë•Œë§ˆë‹¤ Re-rendering ë©ë‹ˆë‹¤. ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ë‚´ë¶€ì ì¸ ë¹„êµë°©ì‹(i.e. Shallow comparison) ë•Œë¬¸ì—, ë¦¬ì•¡íŠ¸ê°€ ì»´í¬ë„ŒíŠ¸ì˜ ë³€ê²½ ì‚¬í•­ì„ í™•ì¸í•˜ëŠ” ê³¼ì •ì—ì„œ ì˜ë„ì¹˜ ì•Šê²Œ ë³€í™”ë¥¼ ê°ì§€í•˜ëŠ” ê²½ìš°ë“¤ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ëŸ° ê²½ìš°ì— ë¦¬ì•¡íŠ¸ëŠ” ë¶ˆí•„ìš”í•œ ë Œë”ë§ì„ ì‹¤í–‰í•˜ê¸°ë„ í•©ë‹ˆë‹¤. useMemoë¥¼ ì´ìš©í•´ ì´ëŸ° ë¶ˆí•„ìš”í•œ ë Œë”ë§ì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì¶”ê°€ì ìœ¼ë¡œ ë§Œì•½ ë Œë”ë§ ê³¼ì •ì— ë³µì¡í•œ ì—°ì‚°ì´ ì¡´ì¬í•œë‹¤ë©´, ìš°ë¦¬ëŠ” useMemoë¥¼ ì´ìš©í•´ ì—°ì‚°ì„ ì¡°ê¸ˆ ë” íš¨ìœ¨ì ìœ¼ë¡œ ë‹¤ë£° ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<aside>
ğŸ“Œ useMemoì™€ React.memoëŠ” ë‹¤ë¦…ë‹ˆë‹¤.

</aside>

[React.memo() vs. useMemo(): Major differences and use cases - LogRocket Blog](https://blog.logrocket.com/react-memo-vs-usememo/)

## ì˜ˆì œ

ì•„ë˜ ì˜ˆì œë¥¼ ì‚´í´ë³´ì‹œê³ , `useMemo`ê°€ ì‚¬ìš©ë˜ì§€ ì•Šì•˜ì„ ê²½ìš°ì™€ ë¹„êµí•˜ì—¬ ì¡°ì‚¬í•´ë³´ì„¸ìš”.

```jsx
function App() {
  const [length, setLength] = useState(5);
  const [name, setName] = useState("Ken Huh");

  return (
    <>
      <input value={name} onChange={(e) => setName(e.target.value)} />
      <Profile name={name} />
      <hr />
      <input
        value={length}
        onChange={(e) => setLength(Number(e.target.value))}
      />
      <FibDisplay length={length} />
    </>
  );
}

function FibDisplay({ length }) {
  const numbers = useMemo(() => {
    console.log("Calculating numbers...");

    const result = [1, 1];

    for (let i = 2; i < length; i++) {
      result[i] = result[i - 1] + result[i - 2];
    }

    return result;
  }, [length]);

  return (
    <p>
      {length} numbers of the fibonacci sequence: {numbers.join(", ")}
    </p>
  );
}

const Profile = React.memo(function ({ name }) {
  console.log("Rerendering profile...");
  return <p>Your name is {name}</p>;
});

export default App;
```

**ğŸ–¥ _Example Link_**

[useMemo](https://codesandbox.io/s/usememo-hk9ek?file=/src/App.js)

# useCallback Hook

useCallbackì€ useMemoì™€ ìœ ì‚¬í•©ë‹ˆë‹¤. ë‹¤ë§Œ, í•¨ìˆ˜ë¥¼ memoize í•œë‹¤ëŠ” ì ì´ ë‹¤ë¥¼ ë¿ì…ë‹ˆë‹¤.

**ğŸ“– _useCallback_**

[Hooks API Reference - React](https://reactjs.org/docs/hooks-reference.html#usecallback)

ìœ„ì—ì„œ ì‚¬ìš©í–ˆë˜ ì˜ˆì œë¥¼ ìì„¸íˆ ì‚´í´ë³´ë©´, App ì»´í¬ë„ŒíŠ¸ëŠ” ë Œë”ë§ ë ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ ë ˆí¼ëŸ°ìŠ¤ì˜ onChange ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë§Œì•½ ì´ í•¸ë“¤ëŸ¬ê°€ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì— propsë¡œ ì „ë‹¬ëœë‹¤ë©´, í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ëŠ” ìƒˆë¡œìš´ ë ˆí¼ëŸ°ìŠ¤ì´ê¸° ë•Œë¬¸ì— props ê°’ì´ ë³€ê²½ëœ ê²ƒìœ¼ë¡œ ì¸ì‹í•˜ê³  ë‹¤ì‹œ ë Œë”ë§ì„ í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ëŸ° ê³¼ì •ì„ íš¨ìœ¨ì ìœ¼ë¡œ ë‹¤ë£¨ê¸° ìœ„í•´ì„œëŠ” useCallbackì´ ë„ì›€ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
function App() {
  const [length, setLength] = useState(3);
  const [name, setName] = useState("Ken Huh");

  const handleNameChange = useCallback((e) => setName(e.target.value), []);
  const handleLengthChange = useCallback(
    (e) => setLength(Number(e.target.value)),
    []
  );

  return (
    <>
      <input value={name} onChange={handleNameChange} />
      <Profile name={name} />
      <hr />
      <input value={length} onChange={handleLengthChange} />
      <FibDisplay length={length} />
    </>
  );
}

function FibDisplay({ length }) {
  const numbers = useMemo(() => {
    console.log("Calculating numbers...");

    const result = [1, 1];

    for (let i = 2; i < length; i++) {
      result[i] = result[i - 1] + result[i - 2];
    }

    return result;
  }, [length]);

  return (
    <p>
      {length} numbers of the fibonacci sequence: {numbers.join(", ")}
    </p>
  );
}

const Profile = React.memo(function ({ name }) {
  console.log("Rerendering Profile...");
  return <p>Your name is {name}</p>;
});

export default App;
```

**ğŸ–¥ _Example Link_**

[useCallback](https://codesandbox.io/s/usecallback-czyb2)

# Extra

[memo()ë¥¼ í•˜ê¸° ì „ì—](https://overreacted.io/ko/before-you-memo/)

[Death by a thousand useCallbacks](https://royi-codes.vercel.app/thousand-usecallbacks/)
